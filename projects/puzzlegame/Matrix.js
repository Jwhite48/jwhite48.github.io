export default class Matrix{constructor(i){this.pieceSize=i,this.piece1=this.image("1.jpg"),this.piece2=this.image("2.jpg"),this.piece3=this.image("3.jpg"),this.piece4=this.image("4.jpg"),this.piece5=this.image("5.jpg"),this.piece6=this.image("6.jpg"),this.piece7=this.image("7.jpg"),this.piece8=this.image("8.jpg"),this.piece9=this.image("9.jpg"),this.piece10=this.image("10.jpg"),this.piece11=this.image("11.jpg"),this.piece12=this.image("12.jpg"),this.piece13=this.image("13.jpg"),this.piece14=this.image("14.jpg"),this.piece15=this.image("15.jpg"),this.piece16=this.image("16.jpg"),this.piece17=this.image("17.jpg"),this.piece18=this.image("18.jpg"),this.piece19=this.image("19.jpg"),this.piece20=this.image("20.jpg"),this.piece21=this.image("21.jpg"),this.piece22=this.image("22.jpg"),this.piece23=this.image("23.jpg"),this.piece24=this.image("24.jpg"),this.matrix,this.win,this.moves,this.setup(4)}image(i){const e=new Image;return e.src=`pieces/${i}`,e}setup(i){let e=Array.from(Array(i*i).keys());do{e=this.shuffle(e)}while(!this.checkSolvability(e,i));const t=[];for(;e.length;)t.push(e.splice(0,i));this.matrix=t,this.moves=0,this.win=!1}shuffle(i){for(var e,t,s=i.length;s;)t=Math.floor(Math.random()*s--),e=i[s],i[s]=i[t],i[t]=e;return i}checkSolvability(i,e){let t=0;for(let e=0;e<i.length-1;e++)for(let s=e+1;s<i.length;s++)i[e]&&i[s]&&i[e]>i[s]&&t++;if(e%2==0){let e=0;for(let t=0;t<i.length;t++)if(0==i[t]){t>=4&&t<8?e=1:t<12?e=2:t<16&&(e=3);break}if((2==e||0==e)&&t%2!=0)return!0;if((3==e||1==e)&&t%2==0)return!0}else if(t%2==0)return!0;return!1}draw(i,e){this.setCanvasSize(i),this.clearCanvas(i,e),this.drawBoard(e)}setCanvasSize(i){i.height=this.matrix.length*this.pieceSize,i.width=this.matrix[0].length*this.pieceSize}clearCanvas(i,e){e.fillStyle="black",e.fillRect(0,0,i.width,i.height)}drawBoard(i){for(let e=0;e<this.matrix.length;e++)for(let t=0;t<this.matrix[e].length;t++){let s=null;switch(this.matrix[e][t]){case 1:s=this.piece1;break;case 2:s=this.piece2;break;case 3:s=this.piece3;break;case 4:s=this.piece4;break;case 5:s=this.piece5;break;case 6:s=this.piece6;break;case 7:s=this.piece7;break;case 8:s=this.piece8;break;case 9:s=this.piece9;break;case 10:s=this.piece10;break;case 11:s=this.piece11;break;case 12:s=this.piece12;break;case 13:s=this.piece13;break;case 14:s=this.piece14;break;case 15:s=this.piece15;break;case 16:s=this.piece16;break;case 17:s=this.piece17;break;case 18:s=this.piece18;break;case 19:s=this.piece19;break;case 20:s=this.piece20;break;case 21:s=this.piece21;break;case 22:s=this.piece22;break;case 23:s=this.piece23;break;case 24:s=this.piece24}null!=s&&i.drawImage(s,t*this.pieceSize,e*this.pieceSize,this.pieceSize,this.pieceSize)}}move(i){var e=0,t=0;for(let i=0;i<this.matrix.length;i++)for(let s=0;s<this.matrix[i].length;s++)if(0==this.matrix[i][s]){e=i,t=s;break}"w"==i&&e!=this.matrix.length-1?(this.matrix[e][t]=this.matrix[e+1][t],this.matrix[e+1][t]=0,this.moves++):"a"==i&&t!=this.matrix[0].length-1?(this.matrix[e][t]=this.matrix[e][t+1],this.matrix[e][t+1]=0,this.moves++):"s"==i&&0!=e?(this.matrix[e][t]=this.matrix[e-1][t],this.matrix[e-1][t]=0,this.moves++):"d"==i&&0!=t&&(this.matrix[e][t]=this.matrix[e][t-1],this.matrix[e][t-1]=0,this.moves++),0==this.matrix[this.matrix.length-1][this.matrix.length-1]&&this.winCond()}winCond(){var i=1;for(let e=0;e<this.matrix.length;e++)for(let t=0;t<this.matrix[e].length;t++){if(e==this.matrix.length-1&&t==this.matrix.length-1&&(i=0),this.matrix[e][t]!=i)return;i++}this.win=!0}};